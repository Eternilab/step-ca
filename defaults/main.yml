---
# State is latest by default
# step_ca_apt_state: latest

# Array of packages to install
# step_ca_apt_packages:
#   - step-ca

step_ca_tmp_dir: /tmp

step_ca_version: 0.26.1

# Hardware Architecture of the step-ca server
# Can be any of :
# amd64, 383, arm64, armv7, armv6, armv5
step_ca_arch: amd64

# How to install step-ca
# Can be any of :
# manual, binary, debian
step_ca_install_mode: manual

# User and group for step daemon
step_ca_user: step
step_ca_group: step

# Install files targets
step_ca_bin_file: /usr/local/bin/step-ca
step_ca_systemd_svc_file: /etc/systemd/system/step-ca.service
step_ca_pid_file: /run/step_ca.pid

# Debian dependencies
step_ca_debian_dep:
  - make
  - gcc
  - ack
  - libpcsclite-dev
  - pkg-config

step_ca_debian_dep_backports:
  - golang

#####
### Manual installation
#####

step_ca_tarball_manual: step-ca_linux_{{ step_ca_version }}.tar.gz

# URL to download source tarball from
step_ca_url_manual: https://github.com/smallstep/certificates/archive/refs/tags/v{{ step_ca_version }}.tar.gz

#####
### Binary installation
#####

step_ca_tarball_binary: step-ca_linux_{{ step_ca_version }}_{{ step_ca_arch }}.tar.gz

# URL to download binary tarball from
step_ca_url_binary: https://github.com/smallstep/certificates/releases/download/v{{ step_ca_version }}/{{ step_ca_tarball }}

#####
### Debian installation
#####

# URL to download Debian pakage from
step_ca_url_deb: https://github.com/smallstep/certificates/releases/download/v{{ step_ca_version }}/step-ca_{{ step_ca_arch }}.deb

step_ca_url_systemd_svc_file: https://raw.githubusercontent.com/smallstep/certificates/v{{ step_ca_version }}/systemd/step-ca.service

step_ca_apt_state: present

#####
### Default user variables
#####


step_ca_templates:
  - templates/certs/x509/root.tpl
  - templates/certs/x509/intermediate_client.tpl
  - templates/certs/x509/intermediate_server.tpl

step_ca_dirlist:
  - certs
  - config
  - db
  - secrets
  - templates/certs/x509


# This will use a YubiHSM to store the intermediate CAs, otherwise it'll be stored on disk.
# true  -> YubiHSM
# false -> Store on disk
step_ca_yubihsm: false

step_ca_root_dir: /etc/step-ca

# Proxy handling
# You can set this variable to be able to go out
# to the internet :
#
proxy_env:
#   http_proxy: http://proxy.example.com:3128
#   https_proxy: http://proxy.example.com:3128
#   ftp_proxy: http://proxy.example.com:3128

# Technical contact
# step_ca_email: "admin@example.com"

# Domain name to sign certificates for
# Used in templating for leaf certificates :
# When a Certificate Signing Request is presented to the CA, the FQDN in
# that CSR must end with this string to be valid.
# step_ca_domain: "example.com"

step_ca_structure:
  rootCA:
    is_root: true
    organisation: "Ma Societe"
    locality: "Paris"
    province: "IDF"
    country: "FR"
    # EC or OKP
    keytype: EC
    # EC: P-256, P-384, P-521
    # OKP: Ed25519
    keycurve: P-384
  SubCA:
    ocspFQDN: "ocsp.example.com"
    instances:
      - name : "S1"
        is_root: false
        organisation: "Ma Societe"
        locality: "Paris"
        province: "IDF"
        country: "FR"
        minTLSCertDuration: "1440h"
        maxTLSCertDuration: "2160h"
        defaultTLSCertDuration: "2160h"
        # match: ".*\\.example\\.com"
        min_key_size_rsa: 512
        extKeyUsage: serverAuth
        IssuingCertificateURL: "http://dist.s1.example.com/example.com-SubCA.der"
        crlDistributionPoints: "http://crl.s1.example.com/crl"
        listen_port: 9100
        insecure_port: 8080
      - name : "C1"
        is_root: false
        organisation: "Ma Societe"
        locality: "Paris"
        province: "IDF"
        country: "FR"
        minTLSCertDuration: "1440h"
        maxTLSCertDuration: "2160h"
        defaultTLSCertDuration: "2160h"
        # match: ".*\\.example\\.com"
        min_key_size_rsa: 512
        extKeyUsage: clientAuth
        IssuingCertificateURL: "http://dist.c1.example.com/example.com-SubCA.der"
        crlDistributionPoints: "http://crl.c1.example.com/crl"
        listen_port: 9101
        insecure_port: 8081
